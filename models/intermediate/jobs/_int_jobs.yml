version: 2

models:
  - name: int_jobs
    description: >
      {{ doc('jobs_hierarchy') }}


      See {{ doc('jobs') }} for overall jobs modelling strategy.
    columns:
      - name: response_id
        description: See {{ doc('response_id') }} for details.
        tests:
          - relationships:
              arguments:
                to: ref('stg_responses')
                field: response_id
      
      - name: raw_job_title
        description: "The original, uncleaned job title from the source system."
        tests:
          - relationships:
              arguments:
                to: ref('stg_responses')
                field: raw_job_title

      - name: department
        description: "The original, uncleaned department from the source system."
        tests:
          - relationships:
              arguments:
                to: ref('stg_responses')
                field: raw_department
                
      - name: title
        description: "The harmonized title after joining with the job_titles reference table."
        tests:
          - not_null

      - name: standardized_title
        description: "The official title assigned based on the highest-priority keyword match."
      - name: hierarchy
        description: "The categorical level (e.g., C-Suite, Senior Management, Scientific Professional)."
      - name: priority
        description: "The ranking value from the seed file used to resolve overlapping matches."