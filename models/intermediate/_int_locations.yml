version: 2

models:
  - name: int_locations
    description: >
      Cleans and deduplicates location data from survey responses.
      Filters to valid countries using the `countries` seed, standardizes
      city names using the `city_names` seed, and produces one row per
      unique location combination.

      See {{ doc('locations') }} for locations modelling strategy.
    columns:

      - name: raw_country
        data_type: string
        description: The original country name as provided by the respondent. 
          This is used for joins harmonization and is not intended for analysis.
          harmonization and is not intended for analysis.

      - name: raw_city
        data_type: string
        description: The original city name as provided by the respondent. 
          This is used for joins harmonization and is not intended for analysis. 
          Null for US/Canada entries that only specify state/province.
          
      - name: country
        data_type: string
        description: "Country name, validated against the `countries` seed."
        tests:
          - not_null

      - name: city
        data_type: string
        description: >
          City name, cleaned via the `city_names` seed.
          Null for US/Canada entries that only specify state/province.

      - name: us_state
        data_type: string
        description: "US state name. Null for non-US locations."

      - name: ca_province
        data_type: string
        description: "Canadian province name. Null for non-Canadian locations."

      - name: subdivision
        data_type: string
        description: "Coalesced from `us_state` and `ca_province`. Null for non-US/Canada locations."