version: 2

models:
  - name: dim_locations
    description: >
      Final location dimension table. One row per unique geographic location,
      with a surrogate key for joining to fact tables.

      See {{ doc('locations') }} for locations modelling strategy.
    columns:
      - name: location_id
        data_type: string
        description: >
          Surrogate key generated using `dbt_utils.generate_surrogate_key`
          with `country`, `city`, and `subdivision`.
        tests:
          - not_null
          - unique

      - name: country
        data_type: string
        description: "Country name, validated against the `countries` seed."
        tests:
          - not_null

      - name: subdivision
        data_type: string
        description: "US state or Canadian province. Null for other countries."

      - name: city
        data_type: string
        description: >
          City name, cleaned via the `city_names` seed.
          Null for US/Canada entries that only specify state/province.

      - name: location_name
        data_type: string
        description: "Human-readable location label (e.g. 'Boston, Massachusetts, United States')."
        tests:
          - not_null
          - unique
